# test pssh from https://github.com/wader/fq/issues/282
$ fq ddv pssh.mp4
     |00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f|0123456789abcdef|.{}: pssh.mp4 (mp4) 0x0-0x4d4 (1236)
     |                                               |                |  boxes[0:3]: 0x0-0x4d4 (1236)
     |                                               |                |    [0]{}: box 0x0-0x24 (36)
0x000|00 00 00 24                                    |...$            |      size: 36 0x0-0x4 (4)
0x000|            66 74 79 70                        |    ftyp        |      type: "ftyp" (File type and compatibility) 0x4-0x8 (4)
0x000|                        69 73 6f 6d            |        isom    |      major_brand: "isom" 0x8-0xc (4)
0x000|                                    00 00 00 01|            ....|      minor_version: 1 0xc-0x10 (4)
     |                                               |                |      brands[0:5]: 0x10-0x24 (20)
0x010|69 73 6f 6d                                    |isom            |        [0]: "isom" brand (All files based on the ISO Base Media File Format) 0x10-0x14 (4)
0x010|            61 76 63 31                        |    avc1        |        [1]: "avc1" brand (Advanced Video Coding extensions) 0x14-0x18 (4)
0x010|                        6d 70 34 32            |        mp42    |        [2]: "mp42" brand (MP4 version 2) 0x18-0x1c (4)
0x010|                                    69 73 6f 35|            iso5|        [3]: "iso5" brand (Version of the ISO file format) 0x1c-0x20 (4)
0x020|69 73 6f 36                                    |iso6            |        [4]: "iso6" brand (Version of the ISO file format) 0x20-0x24 (4)
     |                                               |                |    [1]{}: box 0x24-0x47e (1114)
0x020|            00 00 04 5a                        |    ...Z        |      size: 1114 0x24-0x28 (4)
0x020|                        70 73 73 68            |        pssh    |      type: "pssh" (Protection system specific header) 0x28-0x2c (4)
0x020|                                    00         |            .   |      version: 0 0x2c-0x2d (1)
0x020|                                       00 00 00|             ...|      flags: 0 0x2d-0x30 (3)
0x030|9a 04 f0 79 98 40 42 86 ab 92 e6 5b e0 88 5f 95|...y.@B....[.._.|      system_id: "playready" (raw bits) 0x30-0x40 (16)
0x040|00 00 04 3a                                    |...:            |      data_size: 1082 0x40-0x44 (4)
     |00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f|0123456789abcdef|      data{}: (pssh_playready) 0x44-0x47e (1082)
0x040|            3a 04 00 00                        |    :...        |        size: 1082 0x44-0x48 (4)
0x040|                        01 00                  |        ..      |        count: 1 0x48-0x4a (2)
     |                                               |                |        records[0:1]: 0x4a-0x47e (1076)
     |                                               |                |          [0]{}: record 0x4a-0x47e (1076)
0x040|                              01 00            |          ..    |            type: "rights_management_header" (1) 0x4a-0x4c (2)
0x040|                                    30 04      |            0.  |            len: 1072 0x4c-0x4e (2)
0x040|                                          3c 00|              <.|            xml: "<WRMHEADER xmlns=\"http://schemas.microsoft.com/DRM/2007/03/PlayReadyHeader\" version=\"4.0.0.0\"><DATA><PROTECTINFO><KEYLEN>16</KEYLEN><ALGID>AESCTR</ALGID></PROTECTINFO><KID>xIA3iIGpTEm5lJ6TeS/4pw==</KID><CHECKSUM>32NQEM0v8BU=</CHECKSUM><LA_URL>https://manifest.prod.boltdns.net/license/v1/cenc/playready/6240731308001/01af0a57-214d-4fdd-86fd-f792135ce46f/883780c4-a981-494c-b994-9e93792ff8a7?fastly_token=NjQ3MTU2YTZfYmE2ZjNjNDVlMDQ1NWE3MGMyZjAyYmQzNDVhMGQ3YWQ1ZWE0MzU4NGNjMzQ0NzhhOWVjY2ZlMTkyYjk0MTQ1MA%3D%3D</LA_URL></DATA></WRMHEADER>" 0x4e-0x47e (1072)
0x050|57 00 52 00 4d 00 48 00 45 00 41 00 44 00 45 00|W.R.M.H.E.A.D.E.|
0x060|52 00 20 00 78 00 6d 00 6c 00 6e 00 73 00 3d 00|R. .x.m.l.n.s.=.|
0x070|22 00 68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00|".h.t.t.p.:././.|
0x080|73 00 63 00 68 00 65 00 6d 00 61 00 73 00 2e 00|s.c.h.e.m.a.s...|
0x090|6d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00|m.i.c.r.o.s.o.f.|
0x0a0|74 00 2e 00 63 00 6f 00 6d 00 2f 00 44 00 52 00|t...c.o.m./.D.R.|
0x0b0|4d 00 2f 00 32 00 30 00 30 00 37 00 2f 00 30 00|M./.2.0.0.7./.0.|
0x0c0|33 00 2f 00 50 00 6c 00 61 00 79 00 52 00 65 00|3./.P.l.a.y.R.e.|
0x0d0|61 00 64 00 79 00 48 00 65 00 61 00 64 00 65 00|a.d.y.H.e.a.d.e.|
0x0e0|72 00 22 00 20 00 76 00 65 00 72 00 73 00 69 00|r.". .v.e.r.s.i.|
0x0f0|6f 00 6e 00 3d 00 22 00 34 00 2e 00 30 00 2e 00|o.n.=.".4...0...|
0x100|30 00 2e 00 30 00 22 00 3e 00 3c 00 44 00 41 00|0...0.".>.<.D.A.|
0x110|54 00 41 00 3e 00 3c 00 50 00 52 00 4f 00 54 00|T.A.>.<.P.R.O.T.|
0x120|45 00 43 00 54 00 49 00 4e 00 46 00 4f 00 3e 00|E.C.T.I.N.F.O.>.|
0x130|3c 00 4b 00 45 00 59 00 4c 00 45 00 4e 00 3e 00|<.K.E.Y.L.E.N.>.|
0x140|31 00 36 00 3c 00 2f 00 4b 00 45 00 59 00 4c 00|1.6.<./.K.E.Y.L.|
0x150|45 00 4e 00 3e 00 3c 00 41 00 4c 00 47 00 49 00|E.N.>.<.A.L.G.I.|
0x160|44 00 3e 00 41 00 45 00 53 00 43 00 54 00 52 00|D.>.A.E.S.C.T.R.|
0x170|3c 00 2f 00 41 00 4c 00 47 00 49 00 44 00 3e 00|<./.A.L.G.I.D.>.|
0x180|3c 00 2f 00 50 00 52 00 4f 00 54 00 45 00 43 00|<./.P.R.O.T.E.C.|
0x190|54 00 49 00 4e 00 46 00 4f 00 3e 00 3c 00 4b 00|T.I.N.F.O.>.<.K.|
0x1a0|49 00 44 00 3e 00 78 00 49 00 41 00 33 00 69 00|I.D.>.x.I.A.3.i.|
0x1b0|49 00 47 00 70 00 54 00 45 00 6d 00 35 00 6c 00|I.G.p.T.E.m.5.l.|
0x1c0|4a 00 36 00 54 00 65 00 53 00 2f 00 34 00 70 00|J.6.T.e.S./.4.p.|
0x1d0|77 00 3d 00 3d 00 3c 00 2f 00 4b 00 49 00 44 00|w.=.=.<./.K.I.D.|
0x1e0|3e 00 3c 00 43 00 48 00 45 00 43 00 4b 00 53 00|>.<.C.H.E.C.K.S.|
0x1f0|55 00 4d 00 3e 00 33 00 32 00 4e 00 51 00 45 00|U.M.>.3.2.N.Q.E.|
0x200|4d 00 30 00 76 00 38 00 42 00 55 00 3d 00 3c 00|M.0.v.8.B.U.=.<.|
0x210|2f 00 43 00 48 00 45 00 43 00 4b 00 53 00 55 00|/.C.H.E.C.K.S.U.|
0x220|4d 00 3e 00 3c 00 4c 00 41 00 5f 00 55 00 52 00|M.>.<.L.A._.U.R.|
0x230|4c 00 3e 00 68 00 74 00 74 00 70 00 73 00 3a 00|L.>.h.t.t.p.s.:.|
0x240|2f 00 2f 00 6d 00 61 00 6e 00 69 00 66 00 65 00|/./.m.a.n.i.f.e.|
0x250|73 00 74 00 2e 00 70 00 72 00 6f 00 64 00 2e 00|s.t...p.r.o.d...|
0x260|62 00 6f 00 6c 00 74 00 64 00 6e 00 73 00 2e 00|b.o.l.t.d.n.s...|
0x270|6e 00 65 00 74 00 2f 00 6c 00 69 00 63 00 65 00|n.e.t./.l.i.c.e.|
0x280|6e 00 73 00 65 00 2f 00 76 00 31 00 2f 00 63 00|n.s.e./.v.1./.c.|
0x290|65 00 6e 00 63 00 2f 00 70 00 6c 00 61 00 79 00|e.n.c./.p.l.a.y.|
0x2a0|72 00 65 00 61 00 64 00 79 00 2f 00 36 00 32 00|r.e.a.d.y./.6.2.|
0x2b0|34 00 30 00 37 00 33 00 31 00 33 00 30 00 38 00|4.0.7.3.1.3.0.8.|
0x2c0|30 00 30 00 31 00 2f 00 30 00 31 00 61 00 66 00|0.0.1./.0.1.a.f.|
0x2d0|30 00 61 00 35 00 37 00 2d 00 32 00 31 00 34 00|0.a.5.7.-.2.1.4.|
0x2e0|64 00 2d 00 34 00 66 00 64 00 64 00 2d 00 38 00|d.-.4.f.d.d.-.8.|
0x2f0|36 00 66 00 64 00 2d 00 66 00 37 00 39 00 32 00|6.f.d.-.f.7.9.2.|
0x300|31 00 33 00 35 00 63 00 65 00 34 00 36 00 66 00|1.3.5.c.e.4.6.f.|
0x310|2f 00 38 00 38 00 33 00 37 00 38 00 30 00 63 00|/.8.8.3.7.8.0.c.|
0x320|34 00 2d 00 61 00 39 00 38 00 31 00 2d 00 34 00|4.-.a.9.8.1.-.4.|
0x330|39 00 34 00 63 00 2d 00 62 00 39 00 39 00 34 00|9.4.c.-.b.9.9.4.|
0x340|2d 00 39 00 65 00 39 00 33 00 37 00 39 00 32 00|-.9.e.9.3.7.9.2.|
0x350|66 00 66 00 38 00 61 00 37 00 3f 00 66 00 61 00|f.f.8.a.7.?.f.a.|
0x360|73 00 74 00 6c 00 79 00 5f 00 74 00 6f 00 6b 00|s.t.l.y._.t.o.k.|
0x370|65 00 6e 00 3d 00 4e 00 6a 00 51 00 33 00 4d 00|e.n.=.N.j.Q.3.M.|
0x380|54 00 55 00 32 00 59 00 54 00 5a 00 66 00 59 00|T.U.2.Y.T.Z.f.Y.|
0x390|6d 00 45 00 32 00 5a 00 6a 00 4e 00 6a 00 4e 00|m.E.2.Z.j.N.j.N.|
0x3a0|44 00 56 00 6c 00 4d 00 44 00 51 00 31 00 4e 00|D.V.l.M.D.Q.1.N.|
0x3b0|57 00 45 00 33 00 4d 00 47 00 4d 00 79 00 5a 00|W.E.3.M.G.M.y.Z.|
0x3c0|6a 00 41 00 79 00 59 00 6d 00 51 00 7a 00 4e 00|j.A.y.Y.m.Q.z.N.|
0x3d0|44 00 56 00 68 00 4d 00 47 00 51 00 33 00 59 00|D.V.h.M.G.Q.3.Y.|
0x3e0|57 00 51 00 31 00 5a 00 57 00 45 00 30 00 4d 00|W.Q.1.Z.W.E.0.M.|
0x3f0|7a 00 55 00 34 00 4e 00 47 00 4e 00 6a 00 4d 00|z.U.4.N.G.N.j.M.|
0x400|7a 00 51 00 30 00 4e 00 7a 00 68 00 68 00 4f 00|z.Q.0.N.z.h.h.O.|
0x410|57 00 56 00 6a 00 59 00 32 00 5a 00 6c 00 4d 00|W.V.j.Y.2.Z.l.M.|
0x420|54 00 6b 00 79 00 59 00 6a 00 6b 00 30 00 4d 00|T.k.y.Y.j.k.0.M.|
0x430|54 00 51 00 31 00 4d 00 41 00 25 00 33 00 44 00|T.Q.1.M.A.%.3.D.|
0x440|25 00 33 00 44 00 3c 00 2f 00 4c 00 41 00 5f 00|%.3.D.<./.L.A._.|
0x450|55 00 52 00 4c 00 3e 00 3c 00 2f 00 44 00 41 00|U.R.L.>.<./.D.A.|
0x460|54 00 41 00 3e 00 3c 00 2f 00 57 00 52 00 4d 00|T.A.>.<./.W.R.M.|
0x470|48 00 45 00 41 00 44 00 45 00 52 00 3e 00      |H.E.A.D.E.R.>.  |
     |                                               |                |    [2]{}: box 0x47e-0x4d4 (86)
0x470|                                          00 00|              ..|      size: 86 0x47e-0x482 (4)
0x480|00 56                                          |.V              |
0x480|      70 73 73 68                              |  pssh          |      type: "pssh" (Protection system specific header) 0x482-0x486 (4)
0x480|                  00                           |      .         |      version: 0 0x486-0x487 (1)
0x480|                     00 00 00                  |       ...      |      flags: 0 0x487-0x48a (3)
0x480|                              ed ef 8b a9 79 d6|          ....y.|      system_id: "widevine" (raw bits) 0x48a-0x49a (16)
0x490|4a ce a3 c8 27 dc d5 1d 21 ed                  |J...'...!.      |
0x490|                              00 00 00 36      |          ...6  |      data_size: 54 0x49a-0x49e (4)
     |00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f|0123456789abcdef|      data{}: (protobuf_widevine) 0x49e-0x4d4 (54)
     |                                               |                |        fields[0:5]: 0x49e-0x4d4 (54)
     |                                               |                |          [0]{}: field 0x49e-0x4a0 (2)
0x490|                                          08   |              . |            key_n: 8 0x49e-0x49f (1)
     |                                               |                |            field_number: 1
     |                                               |                |            wire_type: "varint" (0)
0x490|                                             01|               .|            wire_value: 1 0x49f-0x4a0 (1)
     |                                               |                |            name: "algorithm"
     |                                               |                |            type: "enum"
     |                                               |                |            enum: "aesctr"
     |                                               |                |          [1]{}: field 0x4a0-0x4b2 (18)
0x4a0|12                                             |.               |            key_n: 18 0x4a0-0x4a1 (1)
     |                                               |                |            field_number: 2
     |                                               |                |            wire_type: "length_delimited" (2)
0x4a0|   10                                          | .              |            length: 16 0x4a1-0x4a2 (1)
0x4a0|      88 37 80 c4 a9 81 49 4c b9 94 9e 93 79 2f|  .7....IL....y/|            wire_value: raw bits 0x4a2-0x4b2 (16)
0x4b0|f8 a7                                          |..              |
0x4a0|      88 37 80 c4 a9 81 49 4c b9 94 9e 93 79 2f|  .7....IL....y/|            value: raw bits 0x4a2-0x4b2 (16)
0x4b0|f8 a7                                          |..              |
     |                                               |                |            name: "key_id"
     |                                               |                |            type: "bytes"
     |                                               |                |          [2]{}: field 0x4b2-0x4c1 (15)
0x4b0|      1a                                       |  .             |            key_n: 26 0x4b2-0x4b3 (1)
     |                                               |                |            field_number: 3
     |                                               |                |            wire_type: "length_delimited" (2)
0x4b0|         0d                                    |   .            |            length: 13 0x4b3-0x4b4 (1)
0x4b0|            77 69 64 65 76 69 6e 65 5f 74 65 73|    widevine_tes|            wire_value: raw bits 0x4b4-0x4c1 (13)
0x4c0|74                                             |t               |
0x4b0|            77 69 64 65 76 69 6e 65 5f 74 65 73|    widevine_tes|            value: "widevine_test" 0x4b4-0x4c1 (13)
0x4c0|74                                             |t               |
     |                                               |                |            name: "provider"
     |                                               |                |            type: "string"
     |                                               |                |          [3]{}: field 0x4c1-0x4cb (10)
0x4c0|   22                                          | "              |            key_n: 34 0x4c1-0x4c2 (1)
     |                                               |                |            field_number: 4
     |                                               |                |            wire_type: "length_delimited" (2)
0x4c0|      08                                       |  .             |            length: 8 0x4c2-0x4c3 (1)
0x4c0|         31 32 33 34 35 36 37 38               |   12345678     |            wire_value: raw bits 0x4c3-0x4cb (8)
0x4c0|         31 32 33 34 35 36 37 38               |   12345678     |            value: raw bits 0x4c3-0x4cb (8)
     |                                               |                |            name: "content_id"
     |                                               |                |            type: "bytes"
     |                                               |                |          [4]{}: field 0x4cb-0x4d4 (9)
0x4c0|                                 32            |           2    |            key_n: 50 0x4cb-0x4cc (1)
     |                                               |                |            field_number: 6
     |                                               |                |            wire_type: "length_delimited" (2)
0x4c0|                                    07         |            .   |            length: 7 0x4cc-0x4cd (1)
0x4c0|                                       64 65 66|             def|            wire_value: raw bits 0x4cd-0x4d4 (7)
0x4d0|61 75 6c 74|                                   |ault|           |
0x4c0|                                       64 65 66|             def|            value: "default" 0x4cd-0x4d4 (7)
0x4d0|61 75 6c 74|                                   |ault|           |
     |                                               |                |            name: "policy"
     |                                               |                |            type: "string"
